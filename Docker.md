## Шпаргалка по Docker CLI

**Основные команды**
```bash
docker run <имя_образа> # запуск контейнера на основе указанного образа
docker ps # показать список активных контейнеров
docker ps -a # показать все контейнеры, включая остановленные
docker stop <идентификатор_контейнера> # остановить контейнер
docker rm <идентификатор_контейнера> # удалить контейнер
docker images # показать список всех локальных образов
docker pull <имя_образа> # загрузить образ из Docker Hub
docker rmi <идентификатор_образа> # удалить локальный образ
```
**Создание и работа с образами**
```bash
docker build -t <имя_образа>:<тег> <путь_к_Dockerfile> # сборка образа на основе Dockerfile
docker tag <старый_тег> <новый_тег> # пометить образ новым тегом
docker tag <имя_образа>:<старый_тег> <новый_репозиторий>/<новый_тег> # переименовать и пометить образ для загрузки в другой репозиторий
docker push <имя_репозитория>/<имя_образа>:<тег> # отправка образа в Docker Hub или другой реестр
```
**Сети и порты**
```bash
docker network ls # показать список сетей
docker run -p <локальный_порт>:<контейнерный_порт> <имя_образа> # определить соответствие портов при запуске контейнера
```
**Работа с Docker Compose**
```bash
docker-compose up # запустить сервисы, определенные в файле docker-compose.yml
docker-compose down #остановить и удалить сервисы, описанные в файле docker-compose.yml
```
**Работа с Docker Volumes**
```bash
docker volume create <имя_volume> # создать Docker Volume
docker run -v <имя_volume>:<путь_в_контейнере> <имя_образа> # запустить контейнер, подключив Volume
```
**Логирование и Мониторинг**
```bash
docker logs <идентификатор_контейнера> # показать логи контейнера
docker stats <идентификатор_контейнера> # отобразить статистику использования ресурсов контейнера
```
 ## Dockerfile
 Команды по созданию образа фиксируются в необработанном (raw) текстовом документе — Docker-файле:
```
ИНСТРУКЦИЯ аргумент(s)
```
где <ИНСТРУКЦИЯ> — команда для Docker Daemon, а <аргумент> — сам аргумент или конкретные значения, которые передаются в <ИНСТРУКЦИЮ>.

**_NB_**_: инструкции нечувствительны регистру, однако их принято писать «капсом», чтобы визуально отличать от аргументов._

Инструкции объясняют, что Docker Daemon должен сделать до, во время или после запуска контейнера из образа.

Основные инструкции для Dockerfile
-     <FROM> указывает базовый образ, на основе которого нужно создать новый. Чаще всего <FROM> используется для образов с операционной системой и предустановленными компонентами.
 -     <RUN> указывает, какие команды необходимо выполнить внутри контейнера во время сборки образа. Так можно установить зависимости или обновить пакеты до нужной версии.
-     <COPY> и <ADD> копирует файлы из локальной файловой системы в контейнер. Чаще всего копируют исходный код приложения.
-     <WORKDIR> устанавливает рабочую директорию для последующих инструкций. Так можно последовательно работать с файлами в разных директориях.
-     <CMD> определяет аргументы по умолчанию при запуске контейнера.
-     <ENTRYPOINT> задаёт команду, которая будет выполнена при запуске контейнера.
Пример Docker-файла для приложения на Python:
```docker
# Используем базовый образ с Python
FROM python:3.8
# Устанавливаем зависимости
RUN pip install flask
# Копируем исходный код в образ
COPY . /app
# Указываем рабочую директорию
WORKDIR /app
# Определяем команду для запуска приложения
CMD ["python", "app.py"]
```
## Образ Docker (Docker Image)
Для того, чтобы из Dockerfile создать образ и запустить контейнер, нужно::
1.  Перейти в директорию, где лежит dockerfile.
2.  Командой docker build создать образ из файла.
3.  По необходимости, проверить образы командой docker images.
4.  Запустить контейнер из образа командой docker run.
В работе с образами можно использовать теги, чтобы указывать версию образов. По умолчанию, Docker присваивает тег  _<latest>_  при сборке.
```bash
#пример сборки образа с явным указанием тега
docker build -t my-python-app:v1.0
```
Для отправки образа в реестр Docker Hub используются следующие команды:
```bash
docker tag my-python-app:v1.0 username/my-python-app:v1.0docker push username/my-python-app:v1.0
```
Загрузка образа из реестра выполняется командой:
```bash
docker pull username/my-python-app:v1.0
```
Образы Docker статичны. А вот контейнеры — изменяемы. Чтобы «обновить» образ, можно запустить из него контейнер, внести изменения и сохранить состояние в новый образ. Делается это с использованием команды  _<docker commit>_:
```bash
docker commit -m "Добавлены изменения" -a "Автор" container_id username/my-python-app:v1.1
```
Образ Docker представляет собой стандартный формат, который обеспечивает совместимость с Docker Daemon на любой платформе. Эта характеристика позволяет переносить проекты между разными системами без затруднений — контейнеры упаковываются в образы и легко перемещаются. Изоляция всех зависимостей и компонентов внутри образа обеспечивает уверенность в том, что проект успешно "встанет" на целевую платформу с Docker без необходимости дополнительной настройки.
Так, стандартизированный формат образа в сочетании с изолированной средой выполнения контейнера делает процесс переноса проектов между различными системами беспроблемным и эффективным.
